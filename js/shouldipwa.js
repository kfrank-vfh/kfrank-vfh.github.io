function localeStorageAvailable(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}function establishNewLocale(i18nData){i18n&&delete i18n,eval(i18nData),localeStorageAvailable()&&(localStorage.locale=i18n.locale),window.localizationInitialized=!0,localizeCompleteUI()}"serviceWorker"in navigator&&$(function(){navigator.serviceWorker.register("sw.js")}),$(function(){var e;localeStorageAvailable()&&(e=localStorage.locale),e||(e=(e="userLanguage"in navigator?navigator.userLanguage:navigator.language).split("-")[0]);var t=establishNewLocale,n={url:"i18n/"+e+".js",dataType:"script",success:t,error:function(){$.get("i18n/en.js",t,"script")}};$.ajax(n),$("select#langauge-select").change(function(){var e="i18n/"+$(this).val()+".js";$.get(e,establishNewLocale,"script")})});var textByID=function(){return i18n[this.id]},textByClass=function(){return i18n["guide."+this.className.replace("-",".")]};function localizeCompleteUI(){localizeIntroPage(),localizeGuidelinePage(),localizeResultPage(),window.location.hash="intro"}function localizeIntroPage(){var e=$("div#intro"),t=e.find("div[data-role=header]").find("select#langauge-select");t.empty(),Object.keys(i18n).filter(function(e){return 0===e.indexOf("locale.")}).map(function(e){return[e.substring(7),i18n[e]]}).sort(function(e,t){return e[1].localeCompare(t[1])}).forEach(function(e){var n=$('<option value="'+e[0]+'"></option>');n.text(e[1]),n.appendTo(t)});var n=i18n.locale;t.val(n);var i=t.find("option[value="+n+"]").text();t.parent().find("span").text(i);var r=e.find("div[role=main]");r.find("p").html(i18n["intro.text"]),r.find("a").text(i18n["intro.btn"]);var a=e.find("div[data-role=footer]");a.find("span#createdby").text(i18n["intro.footer.createdby"]+" Kevin Frank"),a.find("a#guidepdf").text(i18n["intro.footer.guidelines"]+".pdf")}function localizeGuidelinePage(){var e=$("div#guideline").find("div[role=main]");e.find("h2").add(e.find("p")).text(textByID);var t=e.find("div#browser-container");t.find("fieldset").each(function(){$(this).find("legend").text(i18n[this.id]),$(this).find("label").text(textByClass)}),t.find(".ui-block-b label").text(textByClass);var n=e.find("div#rule-container"),i=$(),r=3,a=$("h"+r);for(a=n.find("h"+r++);a.length;a=n.find("h"+r++))i=i.add(a);i.text(textByID),n.find("fieldset").each(function(){var e=$(this).find("input[name]").first().attr("name");$(this).find("legend").text(i18n[e]),$(this).find("label").text(textByClass)}),e.find("button#btnEvaluate").text(i18n["guide.btn"])}function localizeResultPage(){var e=$("div#result div[role=main]");e.find("h2").add("h3").text(textByID),e.find("a#resultBackBtn").text(i18n["result.btn"])}$(document).on("pagebeforecreate",function(e){if("guideline"===e.target.id){var t=$("div#browser-container"),n=t.find("div.prototype .ui-grid-a").clone();t.find("div.prototype").remove(),browsers.forEach(function(e){"chrome"!==e&&t.append("<hr>");var i=n.clone();i.find("fieldset").attr("id","browser."+e),i.find(".ui-block-a input").each(function(t,n){var i="browser-"+e+"-supported";n.id=i+t,n.name=i}),i.find(".ui-block-a label").each(function(t,n){$(n).attr("for","browser-"+e+"-supported"+t)}),i.find(".ui-block-b input").each(function(t,n){var i="browser-"+e+"-version";n.id=i+t,n.name=i}),i.find(".ui-block-b label").each(function(t,n){$(n).attr("for","browser-"+e+"-version"+t)}),t.append(i)});var i=$("#browser-container .ui-block-a input");i.change(function(){var e=$(this),t=e.parents(".ui-controlgroup-controls ").find("input[value=true]").is(":checked");e.parents(".ui-grid-a").children(".ui-block-b").toggle(t)}),i.change();var r=$("div#rule-container"),a=r.find("div.prototype fieldset").clone();r.find("div.prototype").remove(),function e(t,n,i){if(i.length){var a=$("<h"+t+"></h"+t+">");a.text(i18n[i]),a.appendTo(r)}if(Array.isArray(n))for(var l=0;l<n.length;l++)o(i+"."+n[l]);else{var u=Object.keys(n);for(l=0;l<u.length;l++){var c=u[l],d=i+(i.length?".":"")+c;e(t+1,n[c],d)}}}(2,ruleStructure,""),window.localizationInitialized&&localizeGuidelinePage()}function o(e){var t=a.clone();t.find("input").each(function(t,n){n.id=e+t,n.name=e}),t.find("label").each(function(t,n){$(n).attr("for",e+t)}),r.append(t)}}),$(function(){var e=$("div#result p#overall-result-title"),t=$("div#result p#overall-result-description"),n=$("div#result div#required-feature-block"),i=n.find("div#required-feature-container"),r=$("div#result div#nicetohave-feature-block"),a=r.find("div#nicetohave-feature-container");$("#btnEvaluate").click(function(){var o,l,u=!0,c={},d=$("p#guide.alert.support"),f=$("#browser-container .ui-block-a input[value=true]").filter(":checked");f.length?(d.hide(),f.each(function(e,t){var n=t.name;n=n.substring(8,n.length-10);var i=$(t).parents(".ui-grid-a").find("input[name=browser-"+n+"-version]").val();(i=/\d+([.,]\d+)?/.test(i)?parseFloat(i.replace(",",".")):0)<0&&(i=0),"edge"===n&&i>0&&i<12&&(i=12),c[n]=i})):(u=!1,d.show(),$("h2")[0].scrollIntoView());var s=$("p#guide.alert.features"),p=$("#rule-container input[value=required]").filter(":checked"),v=$("#rule-container input[value=nicetohave]").filter(":checked");if(p.length+v.length?(s.hide(),o=p.map(function(){return this.name}).toArray(),l=v.map(function(){return this.name}).toArray()):(u=!1,s.show(),$("h2")[1].scrollIntoView()),u){var h={},g={};o.forEach(function(e){h[e]=rules[e](c)}),l.forEach(function(e){g[e]=rules[e](c)}),console.dir(h),console.dir(g);var b=function(e){return Object.keys(e).reduce(function(t,n){if("false"===t)return t;var i=e[n],r=Object.keys(i).reduce(function(e,t){if("false"===e)return e;var n=i[t];return"true"===(n="boolean"==typeof n?""+n:n.partial?"partial":"true")?e:n},"true");return"true"===r?t:r},"true")},x=b(h),m=b(g),y="true"===x&&"true"===m?"true":"false"===x?"false":"partial";e.text(i18n["result."+y+".title"]),e.attr("class",y),t.text(i18n["result."+y+".description"]);var w=function(e,t){e.empty(),Object.keys(t).forEach(function(n){var i=n.substring(0,n.lastIndexOf(".")),r=$("<h4></h4>");r.text(i18n[i]+" - "+i18n[n]),r.appendTo(e);var a,o=[],l=t[n],u=function(e){return Object.keys(l).filter(e).map(function(e){var t=i18n["browser."+e],n=l[e].note;return n&&(o.push(n),t+="<sup>"+o.length+"</sup>"),t}).reduce(function(e,t){return e.length?e+", "+t:t},"")},c=u(function(e){var t=l[e];return!0===t||!1===t.partial});c.length&&((a=$("<p></p>")).html(i18n["result.feature.true.prefix"]+c+i18n["result.feature.true.suffix"]),a.appendTo(e));(c=u(function(e){var t=l[e];return"object"==typeof t&&t.partial})).length&&((a=$("<p></p>")).html(i18n["result.feature.partial.prefix"]+c+i18n["result.feature.partial.suffix"]),a.appendTo(e));(c=u(function(e){return!1===l[e]})).length&&((a=$("<p></p>")).html(i18n["result.feature.false.prefix"]+c+i18n["result.feature.false.suffix"]),a.appendTo(e));if(o.length){var d=o.reduce(function(e,t){var n=$("<li></li>");return n.text(t),e.add(n)},$());e.append("<p>"+i18n["result.feature.note"]+":</p>");var f=$("<ol></ol>");f.append(d),e.append(f)}})};n.toggle(Object.keys(h).length>0),w(i,h),r.toggle(Object.keys(g).length>0),w(a,g),$.mobile.navigate("#result")}})});